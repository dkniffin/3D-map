<html>
<head>
	<style>
		canvas { 
			width: 100%; 
			height: 100%;
			/*background-color: black;*/
		}
	</style>
	<script src="lib/js/jquery-1.9.1.min.js"></script>
	<script src="lib/js/three.js"></script>
	
	<!--<script src="lib/js/OBJLoader.js"></script>-->
	<script src="lib/js/ColladaLoader.js"></script>


	<!-- Berries -->
	<script src="lib/js/berries/dist/berries-src.js"></script>

</head>
<body>
<div id="logContainer"></div>
<div id="mapContainer"></div>

<script>
	var logger = B.logger('logContainer');
	var model = B.model('mapContainer');
	var terrain;
	//var light = B.light(-3750,6000,3000).addTo(model);


	var thingsToDo = 0;

	function animateModel() {
		window.requestAnimationFrame(animateModel);
		model._render();
	}

	logger.log('Getting SRTM Data...');
	thingsToDo++;
	$.getJSON('data/srtm-boulder.json', function(data) {
		logger.log('Finished getting SRTM Data.');
		logger.log('Using SRTM Data to create terrain...');
		terrain = B.terrain(data).addTo(model);
		logger.log('Done creating terrain.');
		thingsToDo--;
	});

	logger.log('Getting OSM Data...');
	thingsToDo++;
	var osmDataC;
	$.getJSON('data/boulder-osm.json', function(data) {

		logger.log('Finished getting OSM Data.');
		osmDataC = B.osmdata(data);
		thingsToDo--;
	});

	// Keep checking if everything is done, 
	// and when it is, start animating.
	var timerId = window.setInterval(function(){
		if (thingsToDo == 0) {

			osmDataC.addTo(model);

			//animateModel(model);
			model._startAnimation();
			console.log(model._scene);

			logger.log('Started Animating');
			logger.hide();
			clearInterval(timerId);
		}
	},1000);
	

</script>

</body>
</html>
